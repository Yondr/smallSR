# smallSR ‚Äî Lightweight Super-Resolution & Denoising Pipeline

`smallSR` ‚Äî —Ü–µ –∫–æ–º–ø–∞–∫—Ç–Ω–∏–π, –æ–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–∏–π –ø–∞–π–ø–ª–∞–π–Ω —Å—É–ø–µ—Ä—Ä–µ–∑–æ–ª—é—à–Ω—É (SR) —Ç–∞ –¥–µ–Ω–æ–π–∑—É, —Ä–æ–∑—Ä–æ–±–ª–µ–Ω–∏–π —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –Ω–∏–∑—å–∫–æ—Ä–æ–∑–¥—ñ–ª—å–Ω–∏–º–∏ –ø–æ—Ç–æ–∫–∞–º–∏ –∫–∞–º–µ—Ä (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥ PS3 Eye) —Ç–∞ –¥–ª—è –ø–æ–¥–∞–ª—å—à–æ–≥–æ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –Ω–∞ –º–∞–ª–æ–ø–æ—Ç—É–∂–Ω–∏—Ö –ø—Ä–∏—Å—Ç—Ä–æ—è—Ö —Ç–∏–ø—É **Jetson Nano**.

–ü—Ä–æ—î–∫—Ç –≤–∫–ª—é—á–∞—î:
- –º—É–ª—å—Ç–∏–º–æ–¥–µ–ª—å–Ω–∏–π ¬´teacher¬ª –µ–Ω—Ö–∞–Ω—Å–µ—Ä (NAFNet, RealESRGAN, —ñ–Ω—à—ñ),
- –Ω–µ–≤–µ–ª–∏–∫—É ¬´student¬ª –º–æ–¥–µ–ª—å (`student_sr.pth`), –Ω–∞–≤—á–µ–Ω–Ω—è —è–∫–æ—ó –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö teacher-–ø–∞–π–ø–ª–∞–π–Ω—É,
- Python-—Å–∫—Ä–∏–ø—Ç–∏ –¥–ª—è —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è, —ñ–Ω—Ñ–µ—Ä–µ–Ω—Å—É, –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—ó –º–æ–¥–µ–ª–µ–π –≤ ONNX/FP16,
- –≥–æ—Ç–æ–≤–∏–π image-pipeline –¥–ª—è –ø–∞–∫–µ—Ç–Ω–æ—ó –æ–±—Ä–æ–±–∫–∏.

–ü—Ä–æ—î–∫—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–∏–π –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–æ, —â–æ–± –º–æ–∂–Ω–∞ –±—É–ª–æ –ª–µ–≥–∫–æ –ø–æ–≤—Ç–æ—Ä–∏—Ç–∏, –∞–¥–∞–ø—Ç—É–≤–∞—Ç–∏ –∞–±–æ –æ–ø—Ç–∏–º—ñ–∑—É–≤–∞—Ç–∏ –ø—ñ–¥ GPU/RTX –∞–±–æ –ø—ñ–¥ ARM-–ø–ª–∞—Ç—Ñ–æ—Ä–º–∏.

---

# üöÄ –û—Å–Ω–æ–≤–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ

- **–°—É–ø–µ—Ä—Ä–µ–∑–æ–ª—é—à–Ω 4√ó** –¥–ª—è –Ω–∏–∑—å–∫–æ—Ä–æ–∑–¥—ñ–ª—å–Ω–∏—Ö –∫–∞–º–µ—Ä (640√ó480 ‚Üí 1280√ó1024).
- **–î–µ–Ω–æ–π–∑** + —á–∞—Å—Ç–∫–æ–≤–∏–π **–¥–µ–±–ª—é—Ä** (teacher-–ø–∞–π–ø–ª–∞–π–Ω).
- **Student-–º–æ–¥–µ–ª—å**, —è–∫–∞ –ø–æ–≤—Ç–æ—Ä—é—î —Ä–æ–±–æ—Ç—É —Å–∫–ª–∞–¥–Ω–∏—Ö –µ–Ω—Ö–∞–Ωc–µ—Ä—ñ–≤, –∞–ª–µ –ø—Ä–∞—Ü—é—î —É —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ.
- **–°—É–º—ñ—Å–Ω—ñ—Å—Ç—å –∑ ONNX —Ç–∞ TensorRT**.
- **–ü–∞–∫–µ—Ç–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ–π** —á–µ—Ä–µ–∑ `image_pipeline`.
- **–†–µ–∂–∏–º —Ä–µ–∞–ª—å–Ω–æ–≥–æ —á–∞—Å—É**, –≤–∫–ª—é—á–Ω–æ –∑ PS3 Eye –∫–∞–º–µ—Ä–æ—é.

---

# üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É

mallSR/
‚îÇ
‚îú‚îÄ‚îÄ python/
‚îÇ ‚îú‚îÄ‚îÄ capture_ps3_camera.py # –ó–∞—Ö–æ–ø–ª–µ–Ω–Ω—è –∫–∞–¥—Ä—ñ–≤ PS3 Eye
‚îÇ ‚îú‚îÄ‚îÄ RUN_STUDENT_TEST.py # –Ü–Ω—Ñ–µ—Ä–µ–Ω—Å student-–º–æ–¥–µ–ª—ñ
‚îÇ ‚îú‚îÄ‚îÄ image_pipeline/ # –ú–æ–¥–µ–ª—ñ, –ø–∞–π–ø–ª–∞–π–Ω–∏, –æ–±—Ä–æ–±–∫–∞ –∑–æ–±—Ä–∞–∂–µ–Ω—å
‚îÇ ‚îú‚îÄ‚îÄ train/ # –¢—Ä–µ–Ω—É–≤–∞–Ω–Ω—è student-–º–æ–¥–µ–ª—ñ
‚îÇ ‚îî‚îÄ‚îÄ ... # –£—Ç–∏–ª—ñ—Ç–∏, —Å–∫—Ä–∏–ø—Ç–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—ó, —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
‚îÇ
‚îú‚îÄ‚îÄ weights/
‚îÇ ‚îî‚îÄ‚îÄ student_sr.pth # –Ñ–¥–∏–Ω–∞ –≤–∞–≥–∞, —è–∫—É —Ç—Ä–µ–∫–∞—î Git
‚îÇ
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ requirements.txt
‚îî‚îÄ‚îÄ project_manifest.txt


---

# üì∏ Teacher ‚Üí Student –∫–æ–Ω—Ü–µ–ø—Ü—ñ—è

Teacher-–ø–∞–π–ø–ª–∞–π–Ω —Å–∫–ª–∞–¥–∞—î—Ç—å—Å—è –∑ —Å–∏–ª—å–Ω–∏—Ö –º–æ–¥–µ–ª–µ–π (NAFNet, RealESRGAN, —ñ–Ω—à—ñ), —è–∫—ñ —Å—Ç–≤–æ—Ä—é—é—Ç—å high-quality ground truth.

–ü–æ—Ç—ñ–º student-–º–æ–¥–µ–ª—å –Ω–∞–≤—á–∞—î—Ç—å—Å—è **—ñ–º—ñ—Ç—É–≤–∞—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç teacher-–ø–∞–π–ø–ª–∞–π–Ω–∞**, –∞–ª–µ —É –∑–Ω–∞—á–Ω–æ –∫–æ–º–ø–∞–∫—Ç–Ω—ñ—à—ñ–π –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä—ñ.

–ü–µ—Ä–µ–≤–∞–≥–∏:
- –º–æ–∂–Ω–∞ –∑–∞–ø—É—Å–∫–∞—Ç–∏ –Ω–∞ —Å–ª–∞–±–∫–∏—Ö GPU,
- inference –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ,
- –Ω–∞–≤—á–∞–Ω–Ω—è –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –±–µ–∑ —Ä—É—á–Ω–æ—ó —Ä–æ–∑–º—ñ—Ç–∫–∏.

---

# üîß –Ü–Ω—Å—Ç–∞–ª—è—Ü—ñ—è


git clone https://github.com/Yondr/smallSR.git
cd smallSR
pip install -r requirements.txt



‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫ —Å—Ç—É–¥–µ–Ω—Ç—Å—å–∫–æ—ó –º–æ–¥–µ–ª—ñ
python python/RUN_STUDENT_TEST.py --input path/to/input --output out/


–ê–±–æ –∑–∞–≤–∞–Ω—Ç–∞–∂ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è —É python/get_data_from_cam.py —â–æ–± –∑–Ω—ñ–º–∞—Ç–∏ –∑ PS3 –∫–∞–º–µ—Ä–∏.

üß™ –¢—Ä–µ–Ω—É–≤–∞–Ω–Ω—è student-–º–æ–¥–µ–ª—ñ

train.train_student_sr

python -m train.train_student_sr `
>>   --raw-dir "Y:\gemini\project\data\ps3_captures_corresponding_to_multithread" `
>>   --hires-dir "Y:\gemini\project\data\ps3_out_multithread" `
>>   --raw-val-dir "Y:\gemini\project\data\ps3_captures_corresponding_to_multithread_VALIDATION" `
>>   --hires-val-dir "Y:\gemini\project\data\ps3_out_multithread_VALIDATION" `
>>   --out "Y:\gemini\project\weights\student_sr.pth" `
>>   --epochs 20 --batch-size 8 --patch-size 128 --num-workers 4    

üß± –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è –≤ ONNX
python python/convert_to_onnx.py --weights weights/student_sr.pth

üéØ –¶—ñ–ª—å –ø—Ä–æ—î–∫—Ç—É

–°—Ç–≤–æ—Ä–∏—Ç–∏ –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π, –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏–π, –ª–µ–≥–∫–∏–π SR+–¥–µ–Ω–æ–π–∑ –ø–∞–π–ø–ª–∞–π–Ω, —è–∫–∏–π:
–ø—Ä–∞—Ü—é—î –Ω–∞ –∑–≤–∏—á–∞–π–Ω–∏—Ö –≤—ñ–¥–µ–æ–ø–æ—Ç–æ–∫–∞—Ö (PS3 Eye, USB webcams),
–∑–∞–±–µ–∑–ø–µ—á—É—î –≤–∏—Å–æ–∫—É —è–∫—ñ—Å—Ç—å —á–µ—Ä–µ–∑ teacher‚Üístudent pipeline,
–º–æ–∂–µ –±—É—Ç–∏ —Ä–æ–∑–≥–æ—Ä–Ω—É—Ç–∏–π –Ω–∞ Jetson Nano –≤ —Ä–µ–∂–∏–º—ñ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —á–∞—Å—É.

---

# üìä –õ–æ–≥–∏ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è

–î–∏—Ä–µ–∫—Ç–æ—Ä—ñ—è `training_logs/` –º—ñ—Å—Ç–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –∑–∞–ø—É—Å–∫—ñ–≤ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è student-–º–æ–¥–µ–ª—ñ.

- `training_log.csv`: CSV-—Ñ–∞–π–ª –∑ –º–µ—Ç—Ä–∏–∫–∞–º–∏ loss —Ç–∞ PSNR –¥–ª—è –∫–æ–∂–Ω–æ—ó –µ–ø–æ—Ö–∏.
- `loss_plot.png`: –ì—Ä–∞—Ñ—ñ–∫, —â–æ –ø–æ–∫–∞–∑—É—î —Ç—Ä–µ–Ω—É–≤–∞–ª—å–Ω–∏–π —Ç–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ–π–Ω–∏–π loss –ø–æ –µ–ø–æ—Ö–∞–º.
- `psnr_plot.png`: –ì—Ä–∞—Ñ—ñ–∫, —â–æ –ø–æ–∫–∞–∑—É—î —Ç—Ä–µ–Ω—É–≤–∞–ª—å–Ω–∏–π —Ç–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ–π–Ω–∏–π PSNR –ø–æ –µ–ø–æ—Ö–∞–º.

–¶—ñ —Ñ–∞–π–ª–∏ –≥–µ–Ω–µ—Ä—É—é—Ç—å—Å—è —Å–∫—Ä–∏–ø—Ç–∞–º–∏ `train_student_sr.py` —Ç–∞ `plot_metrics.py`.
